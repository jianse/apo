<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.ntboy.repository.MenusMapperCustom">
    <resultMap id="BaseResultMap" type="cn.ntboy.model.Menus">
        <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 24 11:24:48 CST 2019.
    -->
        <id column="id" jdbcType="INTEGER" property="id" />
        <result column="name" jdbcType="VARCHAR" property="name" />
        <result column="typeid" jdbcType="VARCHAR" property="typeid" />
        <result column="burden" jdbcType="VARCHAR" property="burden" />
        <result column="brief" jdbcType="VARCHAR" property="brief" />
        <result column="price" jdbcType="VARCHAR" property="price" />
        <result column="sums" jdbcType="VARCHAR" property="sums" />
        <result column="price1" jdbcType="VARCHAR" property="price1" />
        <result column="sums1" jdbcType="VARCHAR" property="sums1" />
        <result column="imgpath" jdbcType="VARCHAR" property="imgpath" />
    </resultMap>

    <resultMap id="TypesMap" type="cn.ntboy.model.Types">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Oct 24 11:24:48 CST 2019.
        -->
        <id column="id" jdbcType="INTEGER" property="id" />
        <result column="name" jdbcType="VARCHAR" property="name" />
    </resultMap>

    <!-- 组合对象的映射, 要求sql中为types表的字段设置别名,别名为原名加上前缀type以避免重名的字段-->
    <resultMap id="MenusAndTypesMap" type="cn.ntboy.model.combination.MenusAndTypes">
        <association property="menu" resultMap="BaseResultMap" />
        <association property="type" resultMap="TypesMap" columnPrefix="type"/>
    </resultMap>

    <insert id="insertAndSelectKey" parameterType="cn.ntboy.model.Menus" useGeneratedKeys="true" keyProperty="id">
        insert into menus (id, name, typeid,
        burden, brief, price,
        sums, price1, sums1,
        imgpath)
        values (#{id,jdbcType=INTEGER}, #{name,jdbcType=VARCHAR}, #{typeid,jdbcType=VARCHAR},
        #{burden,jdbcType=VARCHAR}, #{brief,jdbcType=VARCHAR}, #{price,jdbcType=VARCHAR},
        #{sums,jdbcType=VARCHAR}, #{price1,jdbcType=VARCHAR}, #{sums1,jdbcType=VARCHAR},
        #{imgpath,jdbcType=VARCHAR})
    </insert>
    
    <select id="selectAllMenusAndTypes" resultMap="MenusAndTypesMap">
        select menus.*,types.id as typeid,types.name as typename from menus left join types on menus.typeid = types.id
    </select>

</mapper>